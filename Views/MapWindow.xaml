<Window x:Class="BlockchainNetworkAnalyzer.Views.MapWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Interactive Map - Miner Locations" 
        Height="800" Width="1200"
        WindowStartupLocation="CenterOwner">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <materialDesign:ColorZone Grid.Row="0" 
                                  Padding="10" 
                                  materialDesign:ColorZoneAssist.Mode="PrimaryMid">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="Interactive Map" 
                              Foreground="White" 
                              FontSize="18" 
                              FontWeight="Bold" 
                              VerticalAlignment="Center"/>
                    <TextBlock Text=" - Miner Locations &amp; Geolocation" 
                              Foreground="White" 
                              Opacity="0.9"
                              VerticalAlignment="Center" 
                              Margin="10,0,0,0"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button x:Name="LoadMinersBtn" 
                           Content="Load Miners" 
                           Click="LoadMinersBtn_Click"
                           Margin="5,0"/>
                    <Button x:Name="ShowRouteBtn" 
                           Content="Show Route" 
                           Click="ShowRouteBtn_Click"
                           Margin="5,0"
                           IsEnabled="False"/>
                    <Button x:Name="ClearMapBtn" 
                           Content="Clear" 
                           Click="ClearMapBtn_Click"
                           Margin="5,0"/>
                </StackPanel>
            </Grid>
        </materialDesign:ColorZone>

        <!-- Map Container -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- WebView2 for Interactive Map -->
            <Border Grid.Column="0" 
                   BorderBrush="Gray" 
                   BorderThickness="1">
                <Grid x:Name="MapContainer">
                    <TextBlock Text="Loading map..." 
                              HorizontalAlignment="Center" 
                              VerticalAlignment="Center"
                              FontSize="16"/>
                    <!-- WebView2 will be added programmatically -->
                </Grid>
            </Border>

            <!-- Sidebar - Miner List -->
            <materialDesign:Card Grid.Column="1" 
                                Margin="10" 
                                Padding="10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" 
                              Text="Detected Miners" 
                              FontSize="16" 
                              FontWeight="Bold" 
                              Margin="0,0,0,10"/>

                    <ListBox Grid.Row="1" 
                            x:Name="MinerListBox" 
                            SelectionChanged="MinerListBox_SelectionChanged">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Margin="5">
                                    <TextBlock Text="{Binding IPAddress}" 
                                              FontWeight="Bold"/>
                                    <TextBlock Text="{Binding Address}" 
                                              FontSize="11" 
                                              Opacity="0.7"/>
                                    <TextBlock Text="{Binding ConnectionType}" 
                                              FontSize="10" 
                                              Opacity="0.6"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <StackPanel Grid.Row="2" 
                               Margin="0,10,0,0">
                        <Button x:Name="ShowDetailsBtn" 
                               Content="Show Details" 
                               Style="{StaticResource MaterialDesignRaisedButton}"
                               Click="ShowDetailsBtn_Click"
                               IsEnabled="False"/>
                        <Button x:Name="NavigateBtn" 
                               Content="Navigate" 
                               Style="{StaticResource MaterialDesignOutlinedButton}"
                               Margin="0,5,0,0"
                               Click="NavigateBtn_Click"
                               IsEnabled="False"/>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="2" 
               Background="{DynamicResource MaterialDesignDivider}" 
               Padding="10,5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="MapStatusText" 
                          Text="Ready" 
                          VerticalAlignment="Center"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="Markers: " VerticalAlignment="Center"/>
                    <TextBlock x:Name="MarkerCountText" 
                              Text="0" 
                              FontWeight="Bold"
                              VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>

